# ============================================================
# Warrant — Environment Variables
# ============================================================
# Copy this file to .env and fill in values.
#
# Three environments:
#   Local:   Docker Compose services + this .env file
#   Staging: Vercel Preview (dev.warrant.ink) — env vars set in Vercel UI
#   Prod:    Vercel Production (warrant.ink) — env vars set in Vercel UI
#
# IMPORTANT: Do NOT run `vercel env pull` into .env.local — it overrides
# local Docker config with remote Neon/Resend settings. Use .env.vercel
# for Vercel env reference instead.
# ============================================================

# --- Database ---
# Local: Docker Compose Postgres
# Staging: Neon branch connection string (set in Vercel)
# Prod: Neon production connection string (set in Vercel)
DATABASE_URL="postgresql://warrant:warrant_dev@localhost:5432/warrant"

# --- Stripe ---
# Use test mode keys for local + staging, live keys for production.
STRIPE_SECRET_KEY="sk_test_..."
STRIPE_WEBHOOK_SECRET="whsec_..."
STRIPE_MONTHLY_PRICE_ID="price_..."
STRIPE_ANNUAL_PRICE_ID="price_..."

# Set to "true" to enable Stripe Identity verification flow
STRIPE_IDENTITY_ENABLED="false"

# --- Email ---
# Local: Uses Mailpit (SMTP on localhost:1025, UI on localhost:8025)
# Staging/Prod: Uses Resend (set RESEND_API_KEY in Vercel)
EMAIL_PROVIDER="mailpit"
EMAIL_FROM="noreply@warrant.ink"
RESEND_API_KEY=""

# Mailpit SMTP settings (local dev only)
SMTP_HOST="localhost"
SMTP_PORT="1025"

# --- Redis ---
# Local: Docker Compose Redis
# Staging/Prod: Upstash or Vercel KV (set REDIS_URL in Vercel)
REDIS_URL="redis://localhost:6379"

# --- Search ---
# Local: Docker Compose Meilisearch
# Staging/Prod: Meilisearch Cloud (set in Vercel)
MEILISEARCH_HOST="http://localhost:7700"
MEILISEARCH_API_KEY="warrant_meili_dev_key"

# --- App ---
NEXT_PUBLIC_APP_URL="http://localhost:3000"

# --- Dev Login ---
# Dev-only quick-login route/page (/auth/dev-login + /api/auth/login/test)
# Requires BOTH flags set to true for server + client visibility.
ENABLE_DEV_LOGIN="true"
NEXT_PUBLIC_ENABLE_DEV_LOGIN="true"

# --- Blob Storage (Vercel Blob) ---
# Required for image uploads in ALL environments (local, staging, prod).
# Required for `next build` (fails loudly if missing).
# Generate at: Vercel Dashboard → Storage → Blob → Manage → Tokens
BLOB_READ_WRITE_TOKEN=""

# --- Billing ---
# Set to "true" to allow mock billing in non-production (skips Stripe for testing)
ALLOW_MOCK_BILLING="true"

# --- Platform ---
PLATFORM_MARGIN="0.15"
